<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Piedra - Biodiversidad</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: fadeIn 0.6s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .header {
        background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 100%);
        padding: 40px 30px;
        color: white;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .scientific-name {
        font-style: italic;
        font-size: 1.2em;
        opacity: 0.95;
      }

      .content {
        padding: 30px;
      }

      .image-container {
        text-align: center;
        margin: 20px 0;
      }

      .image-container img {
        max-width: 100%;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .info-section {
        margin: 30px 0;
      }

      .info-section h2 {
        color: #5a5a8f;
        margin-bottom: 15px;
        font-size: 1.8em;
        border-left: 4px solid #7f7fd5;
        padding-left: 15px;
      }

      .info-section p {
        line-height: 1.8;
        color: #333;
        font-size: 1.1em;
        margin-bottom: 15px;
      }

      .facts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .fact-card {
        background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        transform: translateY(0);
        transition: transform 0.3s ease;
      }

      .fact-card:hover {
        transform: translateY(-5px);
      }

      .fact-card .label {
        font-size: 0.9em;
        opacity: 0.95;
        margin-bottom: 5px;
      }

      .fact-card .value {
        font-size: 1.4em;
        font-weight: bold;
      }

      .curiosity-box {
        background: #f0f0f8;
        border-left: 4px solid #5a5a8f;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .curiosity-box h3 {
        color: #5a5a8f;
        margin-bottom: 10px;
      }

      .quiz-section {
        background: #f0f0f8;
        padding: 30px;
        border-radius: 15px;
        margin-top: 30px;
      }

      .quiz-section h2 {
        color: #5a5a8f;
        margin-bottom: 20px;
        text-align: center;
      }

      .question {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .question h3 {
        color: #333;
        margin-bottom: 15px;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .option {
        padding: 15px;
        background: white;
        border: 2px solid #d0d0e8;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .option:hover {
        border-color: #7f7fd5;
        background: #f0f0f8;
      }

      .option.correct {
        background: #4caf50;
        color: white;
        border-color: #4caf50;
        animation: pulse 0.5s;
      }

      .option.incorrect {
        background: #f44336;
        color: white;
        border-color: #f44336;
        animation: shake 0.5s;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      .falling-game {
        margin-top: 30px;
      }

      .game-instructions {
        background: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        text-align: center;
        color: #666;
      }

      .game-area {
        position: relative;
        height: 300px;
        background: linear-gradient(180deg, #2c2c3e 0%, #4a4a5e 100%);
        border-radius: 10px;
        overflow: hidden;
        border: 3px solid #7f7fd5;
        cursor: crosshair;
      }

      .falling-item {
        position: absolute;
        font-size: 3em;
        cursor: pointer;
        transition: transform 0.1s ease;
        user-select: none;
      }

      .falling-item:hover {
        transform: scale(1.2);
      }

      .falling-item.collected {
        animation: collectEffect 0.5s ease-out;
      }

      @keyframes collectEffect {
        0% {
          transform: scale(1) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: scale(0.5) rotate(360deg);
          opacity: 0;
        }
      }

      .game-controls {
        display: flex;
        justify-content: space-around;
        margin-top: 15px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .game-stat-box {
        background: white;
        padding: 10px 20px;
        border-radius: 10px;
        text-align: center;
        min-width: 100px;
      }

      .game-stat-box .stat-label {
        font-size: 0.9em;
        color: #666;
        margin-bottom: 5px;
      }

      .game-stat-box .stat-value {
        font-size: 1.5em;
        font-weight: bold;
        color: #5a5a8f;
      }

      .start-game-btn {
        padding: 12px 30px;
        background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 100%);
        color: white;
        border: none;
        border-radius: 20px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.3s ease;
        box-shadow: 0 4px 10px rgba(127, 127, 213, 0.3);
      }

      .start-game-btn:hover {
        transform: scale(1.05);
      }

      .start-game-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .game-over-message {
        text-align: center;
        padding: 20px;
        background: white;
        border-radius: 10px;
        margin-top: 15px;
        display: none;
      }

      .game-over-message h4 {
        color: #5a5a8f;
        margin-bottom: 10px;
      }

      .rock-types-game {
        margin-top: 30px;
      }

      .rock-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .rock-card {
        background: white;
        border: 3px solid #d0d0e8;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        min-height: 150px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .rock-card:hover {
        transform: scale(1.05);
        border-color: #7f7fd5;
      }

      .rock-card .rock-emoji {
        font-size: 3em;
        margin-bottom: 10px;
      }

      .rock-card .rock-name {
        font-size: 1.2em;
        font-weight: bold;
        color: #5a5a8f;
        margin-bottom: 10px;
      }

      .rock-card .rock-info {
        font-size: 0.9em;
        color: #666;
        display: none;
      }

      .rock-card.revealed {
        border-color: #4caf50;
        background: #f0f8f0;
      }

      .rock-card.revealed .rock-info {
        display: block;
      }

      .microhabitat-game {
        margin-top: 30px;
      }

      .organism-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .organism-card {
        background: white;
        border: 3px solid #d0d0e8;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .organism-card:hover {
        transform: scale(1.1);
      }

      .organism-card .organism-emoji {
        font-size: 2.5em;
        margin-bottom: 5px;
      }

      .organism-card .organism-name {
        font-size: 0.8em;
        color: #666;
      }

      .organism-card.correct {
        border-color: #4caf50;
        background: #e8f5e9;
        animation: pulse 0.5s;
      }

      .organism-card.incorrect {
        border-color: #f44336;
        background: #ffebee;
        animation: shake 0.5s;
      }

      .organism-card.disabled {
        opacity: 0.5;
        pointer-events: none;
      }

      .score {
        text-align: center;
        font-size: 1.5em;
        color: #5a5a8f;
        margin-top: 20px;
        font-weight: bold;
      }

      .reset-btn {
        display: block;
        margin: 20px auto;
        padding: 15px 40px;
        background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 100%);
        color: white;
        border: none;
        border-radius: 25px;
        font-size: 1.1em;
        cursor: pointer;
        transition: transform 0.3s ease;
        box-shadow: 0 4px 15px rgba(127, 127, 213, 0.4);
      }

      .reset-btn:hover {
        transform: scale(1.05);
      }

      @media (max-width: 768px) {
        body {
          padding: 0;
        }

        .container {
          border-radius: 0;
        }

        .content {
          padding: 15px;
        }

        .falling-game {
          padding: 15px;
          margin-left: -15px;
          margin-right: -15px;
          border-radius: 0;
          margin-bottom: 15px;
        }

        .game-area {
          height: 250px;
        }

        .game-controls {
          flex-direction: column;
          gap: 10px;
        }

        .game-stat-box {
          width: 100%;
        }

        .header h1 {
          font-size: 2em;
        }

        .header {
          padding: 30px 20px;
        }

        .reset-btn {
          padding: 12px 30px;
          font-size: 1em;
        }

        .facts-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 15px;
        }

        .rock-cards {
          grid-template-columns: 1fr;
        }

        .organism-grid {
          grid-template-columns: repeat(3, 1fr);
          gap: 10px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>🪨 La Piedra</h1>
        <p class="scientific-name">Fragmento mineral sólido</p>
      </div>

      <div class="content">
        <div class="falling-game">
          <h3 style="color: #5a5a8f; text-align: center; margin-bottom: 15px">
            Juego: ¡Recolecta los Minerales!
          </h3>
          <div class="game-instructions">
            ¡Haz clic en los minerales y gemas 💎 que caen! Tienes 30 segundos.
            ¡Evita los escombros 🪨!
          </div>

          <div class="game-area" id="gameArea"></div>

          <div class="game-controls">
            <div class="game-stat-box">
              <div class="stat-label">Puntos</div>
              <div class="stat-value" id="gameScore">0</div>
            </div>
            <div class="game-stat-box">
              <div class="stat-label">Tiempo</div>
              <div class="stat-value" id="gameTime">30</div>
            </div>
            <div class="game-stat-box">
              <div class="stat-label">Minerales</div>
              <div class="stat-value" id="gameCount">0</div>
            </div>
          </div>

          <div style="text-align: center; margin-top: 15px">
            <button
              class="start-game-btn"
              id="startGameBtn"
              onclick="startFallingGame()"
            >
              Iniciar Juego
            </button>
          </div>

          <div class="game-over-message" id="gameOverMessage">
            <h4>🎉 ¡Juego Terminado!</h4>
            <p id="finalScoreMessage"></p>
          </div>
        </div>

        <div class="image-container">
          <img
            src="https://images.unsplash.com/photo-1611324990865-b8bbff912d0c?w=800"
            alt="Piedras"
          />
        </div>

        <div class="info-section">
          <h2>Sobre las Piedras</h2>
          <p>
            Las piedras y rocas son fragmentos de minerales sólidos que forman
            la corteza terrestre. Son testigos silenciosos de la historia de
            nuestro planeta, algunas con millones o incluso miles de millones de
            años de antigüedad. Cada piedra cuenta una historia sobre las
            condiciones geológicas que la formaron.
          </p>
          <p>
            Existen tres tipos principales de rocas: ígneas (formadas por magma
            enfriado), sedimentarias (formadas por la acumulación y compactación
            de sedimentos), y metamórficas (formadas cuando otras rocas se
            transforman por calor y presión). Este ciclo de formación, erosión y
            transformación se conoce como el ciclo de las rocas.
          </p>
        </div>

        <div class="facts-grid">
          <div class="fact-card">
            <div class="label">Edad máxima</div>
            <div class="value">4,400 millones años</div>
          </div>
          <div class="fact-card">
            <div class="label">Tipos de rocas</div>
            <div class="value">3 grupos</div>
          </div>
          <div class="fact-card">
            <div class="label">Minerales conocidos</div>
            <div class="value">+5,000</div>
          </div>
          <div class="fact-card">
            <div class="label">Ciclo de las rocas</div>
            <div class="value">Continuo</div>
          </div>
        </div>

        <div class="curiosity-box">
          <h3>💡 ¿Sabías que...?</h3>
          <p>
            La roca más antigua encontrada en la Tierra es un cristal de circón
            de Australia que tiene 4,400 millones de años, ¡casi tan antiguo
            como el planeta mismo! Las piedras no son objetos "muertos", sino
            que están en constante transformación a través del ciclo de las
            rocas. Una roca puede ser erosionada por el agua, convertirse en
            sedimento, compactarse en roca sedimentaria, hundirse en la Tierra
            donde el calor y la presión la transforman en roca metamórfica, y
            finalmente fundirse y volver a solidificarse como roca ígnea. Este
            proceso puede tomar millones de años.
          </p>
        </div>

        <div class="info-section">
          <h2>Importancia en la Biodiversidad</h2>
          <p>
            Aunque las piedras parecen inertes, son fundamentales para la vida.
            Proporcionan minerales esenciales al suelo cuando se erosionan,
            permitiendo que las plantas crezcan. Las formaciones rocosas crean
            microhábitats únicos donde viven líquenes, musgos, insectos y
            pequeños animales.
          </p>
          <p>
            Bajo las piedras se crea un microclima especial: húmedo, oscuro y
            protegido. Aquí viven salamandras, escarabajos, arañas, ciempiés,
            lombrices y muchos otros invertebrados. Las piedras en arroyos y
            ríos son hogar de algas, insectos acuáticos y sus larvas. Las
            cavernas y grietas en las rocas proporcionan refugio a murciélagos,
            aves y otros animales. Sin las piedras, estos ecosistemas no
            existirían.
          </p>
        </div>

        <div class="quiz-section">
          <h2>🎮 ¡Demuestra lo que aprendiste!</h2>

          <div class="question" id="q1">
            <h3>1. ¿Cuántos grupos principales de rocas existen?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(1, 0, false)">
                2 grupos
              </div>
              <div class="option" onclick="checkAnswer(1, 1, true)">
                3 grupos
              </div>
              <div class="option" onclick="checkAnswer(1, 2, false)">
                5 grupos
              </div>
            </div>
          </div>

          <div class="question" id="q2">
            <h3>2. ¿Cómo se llaman las rocas formadas por magma enfriado?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(2, 0, false)">
                Sedimentarias
              </div>
              <div class="option" onclick="checkAnswer(2, 1, false)">
                Metamórficas
              </div>
              <div class="option" onclick="checkAnswer(2, 2, true)">Ígneas</div>
            </div>
          </div>

          <div class="question" id="q3">
            <h3>3. ¿Qué edad tiene la roca más antigua encontrada?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(3, 0, false)">
                100 millones de años
              </div>
              <div class="option" onclick="checkAnswer(3, 1, false)">
                1,000 millones de años
              </div>
              <div class="option" onclick="checkAnswer(3, 2, true)">
                4,400 millones de años
              </div>
            </div>
          </div>

          <div class="score" id="quizScore"></div>
          <button
            class="reset-btn"
            onclick="resetQuiz()"
            style="display: none"
            id="quizResetBtn"
          >
            Intentar de nuevo
          </button>
        </div>

        <div class="quiz-section rock-types-game">
          <h2>🔍 Descubre los Tipos de Rocas</h2>
          <div class="game-instructions">
            Haz clic en cada tipo de roca para descubrir cómo se forma
          </div>

          <div class="rock-cards">
            <div class="rock-card" onclick="revealRock(0)">
              <div class="rock-emoji">🌋</div>
              <div class="rock-name">Ígneas</div>
              <div class="rock-info">
                Se forman cuando el magma se enfría y solidifica, ya sea bajo
                tierra o en la superficie después de una erupción volcánica.
                Ejemplos: granito, basalto.
              </div>
            </div>

            <div class="rock-card" onclick="revealRock(1)">
              <div class="rock-emoji">🏖️</div>
              <div class="rock-name">Sedimentarias</div>
              <div class="rock-info">
                Se forman por la acumulación y compactación de sedimentos como
                arena, barro o restos de organismos. Ejemplos: arenisca, caliza.
              </div>
            </div>

            <div class="rock-card" onclick="revealRock(2)">
              <div class="rock-emoji">💪</div>
              <div class="rock-name">Metamórficas</div>
              <div class="rock-info">
                Se forman cuando otras rocas se transforman por calor extremo y
                presión bajo la superficie terrestre. Ejemplos: mármol, pizarra.
              </div>
            </div>
          </div>

          <div class="score" id="rockScore"></div>
        </div>

        <div class="quiz-section microhabitat-game">
          <h2>🐛 Microhábitat: ¿Quién Vive Bajo las Piedras?</h2>
          <div class="game-instructions">
            ¡Haz clic en los organismos que realmente viven bajo las piedras!
          </div>

          <div class="organism-grid">
            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Lombriz"
            >
              <div class="organism-emoji">🪱</div>
              <div class="organism-name">Lombriz</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, false)"
              data-name="Mariposa"
            >
              <div class="organism-emoji">🦋</div>
              <div class="organism-name">Mariposa</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Escarabajo"
            >
              <div class="organism-emoji">🪲</div>
              <div class="organism-name">Escarabajo</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Araña"
            >
              <div class="organism-emoji">🕷️</div>
              <div class="organism-name">Araña</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, false)"
              data-name="Águila"
            >
              <div class="organism-emoji">🦅</div>
              <div class="organism-name">Águila</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Ciempiés"
            >
              <div class="organism-emoji">🐛</div>
              <div class="organism-name">Ciempiés</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Salamandra"
            >
              <div class="organism-emoji">🦎</div>
              <div class="organism-name">Salamandra</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, false)"
              data-name="Pez"
            >
              <div class="organism-emoji">🐟</div>
              <div class="organism-name">Pez</div>
            </div>

            <div
              class="organism-card"
              onclick="selectOrganism(this, true)"
              data-name="Caracol"
            >
              <div class="organism-emoji">🐌</div>
              <div class="organism-name">Caracol</div>
            </div>
          </div>

          <div class="score" id="microScore">Correctas: 0/6</div>
          <button
            class="reset-btn"
            onclick="resetMicrohabitat()"
            style="display: none"
            id="microResetBtn"
          >
            Jugar de nuevo
          </button>
        </div>
      </div>
    </div>

    <script>
      // Falling Minerals Game
      let gameScore = 0;
      let gameTime = 30;
      let gameCount = 0;
      let gameActive = false;
      let gameTimer = null;
      let spawnInterval = null;

      function startFallingGame() {
        gameScore = 0;
        gameTime = 30;
        gameCount = 0;
        gameActive = true;

        document.getElementById('gameScore').textContent = '0';
        document.getElementById('gameTime').textContent = '30';
        document.getElementById('gameCount').textContent = '0';
        document.getElementById('gameOverMessage').style.display = 'none';
        document.getElementById('startGameBtn').disabled = true;
        document.getElementById('gameArea').innerHTML = '';

        gameTimer = setInterval(() => {
          gameTime--;
          document.getElementById('gameTime').textContent = gameTime;

          if (gameTime <= 0) {
            endFallingGame();
          }
        }, 1000);

        spawnInterval = setInterval(spawnFallingItem, 700);
      }

      function spawnFallingItem() {
        if (!gameActive) return;

        const gameArea = document.getElementById('gameArea');
        const item = document.createElement('div');
        item.className = 'falling-item';

        const rand = Math.random();
        let itemType, emoji, points;

        if (rand < 0.6) {
          const gems = ['💎', '💍', '🔮', '✨'];
          itemType = 'gem';
          emoji = gems[Math.floor(Math.random() * gems.length)];
          points = 15;
        } else {
          itemType = 'debris';
          emoji = '🪨';
          points = -20;
        }

        item.textContent = emoji;
        item.dataset.type = itemType;
        item.dataset.points = points;

        const leftPosition = Math.random() * (gameArea.offsetWidth - 60);
        item.style.left = leftPosition + 'px';
        item.style.top = '-60px';

        gameArea.appendChild(item);

        item.addEventListener('click', () => {
          if (!gameActive) return;

          const pts = parseInt(item.dataset.points);
          gameScore = Math.max(0, gameScore + pts);
          document.getElementById('gameScore').textContent = gameScore;

          if (pts > 0) {
            gameCount++;
            document.getElementById('gameCount').textContent = gameCount;
          }

          item.classList.add('collected');
          setTimeout(() => item.remove(), 500);
        });

        let topPosition = -60;
        const fallSpeed = 2.5 + Math.random() * 2;
        const fallInterval = setInterval(() => {
          if (!gameActive) {
            clearInterval(fallInterval);
            item.remove();
            return;
          }

          topPosition += fallSpeed;
          item.style.top = topPosition + 'px';

          if (topPosition > gameArea.offsetHeight) {
            clearInterval(fallInterval);
            item.remove();

            if (parseInt(item.dataset.points) > 0) {
              gameScore = Math.max(0, gameScore - 5);
              document.getElementById('gameScore').textContent = gameScore;
            }
          }
        }, 30);
      }

      function endFallingGame() {
        gameActive = false;
        clearInterval(gameTimer);
        clearInterval(spawnInterval);

        document.getElementById('startGameBtn').disabled = false;
        document.getElementById('gameArea').innerHTML = '';

        const gameOverMsg = document.getElementById('gameOverMessage');
        const finalMsg = document.getElementById('finalScoreMessage');

        let message = '';
        if (gameScore >= 250) {
          message = `¡Increíble! Recolectaste ${gameCount} minerales con ${gameScore} puntos. ¡Eres un geólogo experto! 🏆`;
        } else if (gameScore >= 150) {
          message = `¡Muy bien! Recolectaste ${gameCount} minerales con ${gameScore} puntos. ¡Buen trabajo! 👏`;
        } else {
          message = `Recolectaste ${gameCount} minerales con ${gameScore} puntos. ¡Sigue practicando! 💪`;
        }

        finalMsg.textContent = message;
        gameOverMsg.style.display = 'block';
      }

      // Quiz
      let quizScore = 0;
      let quizAnswered = 0;
      const totalQuestions = 3;

      function checkAnswer(questionNum, optionIndex, isCorrect) {
        const question = document.getElementById('q' + questionNum);
        const options = question.querySelectorAll('.option');

        if (
          options[optionIndex].classList.contains('correct') ||
          options[optionIndex].classList.contains('incorrect')
        ) {
          return;
        }

        options.forEach((opt) => (opt.style.pointerEvents = 'none'));

        if (isCorrect) {
          options[optionIndex].classList.add('correct');
          quizScore++;
        } else {
          options[optionIndex].classList.add('incorrect');
          options.forEach((opt) => {
            if (opt.onclick.toString().includes('true')) {
              opt.classList.add('correct');
            }
          });
        }

        quizAnswered++;
        updateQuizScore();
      }

      function updateQuizScore() {
        const scoreDiv = document.getElementById('quizScore');
        const resetBtn = document.getElementById('quizResetBtn');

        if (quizAnswered === totalQuestions) {
          const percentage = (quizScore / totalQuestions) * 100;
          let message =
            percentage === 100
              ? '🎉 ¡Perfecto! ¡Eres un experto en geología!'
              : percentage >= 66
              ? '👏 ¡Muy bien! Conoces mucho sobre las rocas.'
              : '🪨 ¡Sigue aprendiendo! Las piedras son fascinantes.';

          scoreDiv.innerHTML = `Puntuación: ${quizScore}/${totalQuestions}<br>${message}`;
          resetBtn.style.display = 'block';
        }
      }

      function resetQuiz() {
        quizScore = 0;
        quizAnswered = 0;

        for (let i = 1; i <= totalQuestions; i++) {
          const question = document.getElementById('q' + i);
          const options = question.querySelectorAll('.option');
          options.forEach((opt) => {
            opt.classList.remove('correct', 'incorrect');
            opt.style.pointerEvents = 'auto';
          });
        }

        document.getElementById('quizScore').innerHTML = '';
        document.getElementById('quizResetBtn').style.display = 'none';
      }

      // Rock Types Discovery Game
      let rocksRevealed = 0;

      function revealRock(index) {
        const cards = document.querySelectorAll('.rock-card');
        const card = cards[index];

        if (!card.classList.contains('revealed')) {
          card.classList.add('revealed');
          rocksRevealed++;
          updateRockScore();
        }
      }

      function updateRockScore() {
        const scoreDiv = document.getElementById('rockScore');
        if (rocksRevealed === 3) {
          scoreDiv.innerHTML =
            '🎊 ¡Excelente! ¡Descubriste los 3 tipos de rocas!';
        } else {
          scoreDiv.innerHTML = `Rocas descubiertas: ${rocksRevealed}/3`;
        }
      }

      // Microhabitat Game
      let microCorrect = 0;
      let microAnswered = 0;
      const totalOrganisms = 9;
      const correctOrganisms = 6;

      function selectOrganism(card, isCorrect) {
        if (card.classList.contains('disabled')) return;

        card.classList.add('disabled');
        microAnswered++;

        if (isCorrect) {
          card.classList.add('correct');
          microCorrect++;
        } else {
          card.classList.add('incorrect');
        }

        updateMicroScore();
      }

      function updateMicroScore() {
        const scoreDiv = document.getElementById('microScore');
        const resetBtn = document.getElementById('microResetBtn');

        scoreDiv.textContent = `Correctas: ${microCorrect}/${correctOrganisms}`;

        if (microAnswered === totalOrganisms) {
          if (microCorrect === correctOrganisms) {
            scoreDiv.innerHTML = `Correctas: ${microCorrect}/${correctOrganisms}<br>🎊 ¡Perfecto! ¡Conoces muy bien los microhábitats!`;
          } else {
            scoreDiv.innerHTML = `Correctas: ${microCorrect}/${correctOrganisms}<br>¡Buen intento! Sigue aprendiendo sobre los ecosistemas.`;
          }
          resetBtn.style.display = 'block';
        }
      }

      function resetMicrohabitat() {
        microCorrect = 0;
        microAnswered = 0;

        const cards = document.querySelectorAll('.organism-card');
        cards.forEach((card) => {
          card.classList.remove('disabled', 'correct', 'incorrect');
        });

        document.getElementById('microScore').textContent = 'Correctas: 0/6';
        document.getElementById('microResetBtn').style.display = 'none';
      }
    </script>
  </body>
</html>
