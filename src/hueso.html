<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hueso - Biodiversidad</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #c9a186 0%, #e4d4c8 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: fadeIn 0.6s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .header {
        background: linear-gradient(135deg, #a67c52 0%, #c9a186 100%);
        padding: 40px 30px;
        color: white;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .scientific-name {
        font-style: italic;
        font-size: 1.2em;
        opacity: 0.95;
      }

      .content {
        padding: 30px;
      }

      .image-container {
        text-align: center;
        margin: 20px 0;
      }

      .image-container img {
        max-width: 100%;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .info-section {
        margin: 30px 0;
      }

      .info-section h2 {
        color: #a67c52;
        margin-bottom: 15px;
        font-size: 1.8em;
        border-left: 4px solid #c9a186;
        padding-left: 15px;
      }

      .info-section p {
        line-height: 1.8;
        color: #333;
        font-size: 1.1em;
        margin-bottom: 15px;
      }

      .facts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .fact-card {
        background: linear-gradient(135deg, #a67c52 0%, #c9a186 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        transition: transform 0.3s ease;
      }

      .fact-card:hover {
        transform: translateY(-5px);
      }

      .fact-card .label {
        font-size: 0.9em;
        opacity: 0.95;
        margin-bottom: 5px;
      }

      .fact-card .value {
        font-size: 1.4em;
        font-weight: bold;
      }

      .curiosity-box {
        background: #faf6f2;
        border-left: 4px solid #a67c52;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .curiosity-box h3 {
        color: #a67c52;
        margin-bottom: 10px;
      }

      .quiz-section {
        background: #faf6f2;
        padding: 30px;
        border-radius: 15px;
        margin-top: 30px;
      }

      .quiz-section h2 {
        color: #a67c52;
        margin-bottom: 20px;
        text-align: center;
      }

      .question {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .question h3 {
        color: #333;
        margin-bottom: 15px;
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .option {
        padding: 15px;
        background: white;
        border: 2px solid #e8dfd6;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .option:hover {
        border-color: #a67c52;
        background: #faf6f2;
      }

      .option.correct {
        background: #4caf50;
        color: white;
        border-color: #4caf50;
      }

      .option.incorrect {
        background: #f44336;
        color: white;
        border-color: #f44336;
      }

      .skeleton-game {
        margin-top: 30px;
      }

      .game-instructions {
        background: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        text-align: center;
        color: #666;
      }

      .skeleton-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin: 20px 0;
      }

      .bone-card {
        background: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 3px solid #e8dfd6;
        min-height: 120px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .bone-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      }

      .bone-card.flipped {
        background: linear-gradient(135deg, #a67c52 0%, #c9a186 100%);
        color: white;
        border-color: #a67c52;
      }

      .bone-card .icon {
        font-size: 2.5em;
        margin-bottom: 10px;
      }

      .bone-card .name {
        font-weight: bold;
        font-size: 1.1em;
      }

      .bone-card .info {
        display: none;
        margin-top: 10px;
        font-size: 0.9em;
        line-height: 1.4;
      }

      .bone-card.flipped .info {
        display: block;
      }

      .matching-game {
        margin-top: 30px;
      }

      .matching-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin: 20px 0;
      }

      .matching-column h3 {
        color: #a67c52;
        margin-bottom: 15px;
        text-align: center;
      }

      .matching-item {
        padding: 15px;
        background: white;
        border: 3px solid #e8dfd6;
        border-radius: 10px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .matching-item:hover {
        border-color: #a67c52;
        background: #faf6f2;
      }

      .matching-item.selected {
        border-color: #a67c52;
        background: linear-gradient(135deg, #a67c52 0%, #c9a186 100%);
        color: white;
        font-weight: bold;
      }

      .matching-item.matched {
        border-color: #4caf50;
        background: #e8f5e9;
        color: #2e7d32;
        pointer-events: none;
      }

      .score {
        text-align: center;
        font-size: 1.5em;
        color: #a67c52;
        margin-top: 20px;
        font-weight: bold;
      }

      .reset-btn {
        display: block;
        margin: 20px auto;
        padding: 15px 40px;
        background: linear-gradient(135deg, #a67c52 0%, #c9a186 100%);
        color: white;
        border: none;
        border-radius: 25px;
        font-size: 1.1em;
        cursor: pointer;
        transition: transform 0.3s ease;
        box-shadow: 0 4px 15px rgba(166, 124, 82, 0.4);
      }

      .reset-btn:hover {
        transform: scale(1.05);
      }

      @media (max-width: 768px) {
        body {
          padding: 0;
        }

        .container {
          border-radius: 0;
        }

        .content {
          padding: 15px;
        }

        .header h1 {
          font-size: 2em;
        }

        .header {
          padding: 30px 20px;
        }

        .reset-btn {
          padding: 12px 30px;
          font-size: 1em;
        }

        .facts-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 15px;
        }

        .quiz-section {
          padding: 15px;
          margin-left: -15px;
          margin-right: -15px;
          border-radius: 0;
        }

        .skeleton-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
        }

        .matching-container {
          grid-template-columns: 1fr;
          gap: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>🦴 El Hueso</h1>
        <p class="scientific-name">Estructura esquelética</p>
      </div>

      <div class="content">
        <div class="quiz-section skeleton-game" style="margin-top: 0;">
          <h2>🧩 Rompecabezas del Esqueleto</h2>
          <div class="game-instructions">
            ¡Ordena los huesos del esqueleto! Arrastra cada hueso a su posición correcta.
          </div>

          <div id="puzzleContainer" style="min-height: 300px; background: white; border-radius: 15px; padding: 20px; margin: 20px 0; position: relative;">
            <div id="puzzleGrid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
              <div class="puzzle-slot" data-id="skull" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Cráneo</span>
              </div>
              <div class="puzzle-slot" data-id="ribs" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Costillas</span>
              </div>
              <div class="puzzle-slot" data-id="spine" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Columna</span>
              </div>
              <div class="puzzle-slot" data-id="arm" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Brazo</span>
              </div>
              <div class="puzzle-slot" data-id="pelvis" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Pelvis</span>
              </div>
              <div class="puzzle-slot" data-id="leg" style="min-height: 100px; border: 3px dashed #e8dfd6; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3em;">
                <span class="slot-label" style="font-size: 0.3em; color: #999;">Pierna</span>
              </div>
            </div>

            <div id="puzzlePieces" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; padding: 20px; background: #faf6f2; border-radius: 10px;">
              <div class="puzzle-piece" draggable="true" data-id="leg" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">🦵</div>
              <div class="puzzle-piece" draggable="true" data-id="skull" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">💀</div>
              <div class="puzzle-piece" draggable="true" data-id="ribs" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">🫁</div>
              <div class="puzzle-piece" draggable="true" data-id="arm" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">💪</div>
              <div class="puzzle-piece" draggable="true" data-id="pelvis" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">🦴</div>
              <div class="puzzle-piece" draggable="true" data-id="spine" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">🔗</div>
            </div>
          </div>

          <div class="score" id="puzzleScore">Piezas colocadas: 0/6</div>
          <button class="reset-btn" onclick="resetPuzzle()" style="display: none;" id="puzzleResetBtn">Reiniciar Rompecabezas</button>
        </div>

        <div class="image-container">
          <img
            src="https://images.unsplash.com/photo-1530210124550-912dc1381cb8?w=800"
            alt="Hueso"
          />
        </div>

        <div class="info-section">
          <h2>Sobre los Huesos</h2>
          <p>
            Los huesos son estructuras duras y resistentes que forman el
            esqueleto de los vertebrados. Están compuestos principalmente de
            calcio y fósforo, junto con colágeno que les da flexibilidad. Los
            huesos no solo sostienen el cuerpo, sino que también protegen
            órganos vitales, permiten el movimiento y producen células
            sanguíneas.
          </p>
          <p>
            En la naturaleza, los huesos que encontramos son vestigios de
            animales que vivieron en ese ecosistema. Son importantes para el
            ciclo de nutrientes, ya que al descomponerse devuelven minerales
            como calcio al suelo, enriqueciendo el ecosistema. Muchos animales
            roen huesos para obtener estos minerales esenciales.
          </p>
        </div>

        <div class="facts-grid">
          <div class="fact-card">
            <div class="label">Huesos humanos</div>
            <div class="value">206</div>
          </div>
          <div class="fact-card">
            <div class="label">Composición calcio</div>
            <div class="value">65%</div>
          </div>
          <div class="fact-card">
            <div class="label">Resistencia</div>
            <div class="value">Como acero</div>
          </div>
          <div class="fact-card">
            <div class="label">Renovación</div>
            <div class="value">10 años</div>
          </div>
        </div>

        <div class="curiosity-box">
          <h3>💡 ¿Sabías que...?</h3>
          <p>
            Los huesos son más fuertes que el acero cuando se comparan peso por
            peso. Un hueso del tamaño de una caja de fósforos puede soportar el
            peso de ¡9 toneladas! Además, el hueso más pequeño del cuerpo humano
            está en el oído (el estribo, de solo 3mm), mientras que el más largo
            es el fémur (puede medir hasta 50cm). Los huesos se renuevan
            completamente cada 10 años, aunque nosotros no lo notemos.
          </p>
        </div>

        <div class="info-section">
          <h2>Importancia en la Biodiversidad</h2>
          <p>
            Los huesos que encontramos en la naturaleza son una parte esencial
            del ecosistema. Cuando un animal muere, sus huesos se convierten en
            fuente de calcio y otros minerales para carroñeros, roedores y hasta
            insectos. Los buitres, hienas y otros carroñeros tienen mandíbulas y
            sistemas digestivos especializados para aprovechar los huesos.
          </p>
          <p>
            Los paleontólogos estudian huesos fosilizados para entender la
            historia de la vida en la Tierra. Los fósiles de huesos nos han
            revelado cómo eran los dinosaurios, los mamuts, y muchas especies
            extintas. Los huesos son archivos biológicos que preservan
            información sobre dietas, enfermedades y el ambiente del pasado.
          </p>
        </div>

        <div class="quiz-section">
          <h2>🎮 ¡Demuestra lo que aprendiste!</h2>

          <div class="question" id="q1">
            <h3>1. ¿De qué están compuestos principalmente los huesos?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(1, 0, true)">
                Calcio y fósforo
              </div>
              <div class="option" onclick="checkAnswer(1, 1, false)">
                Solo agua
              </div>
              <div class="option" onclick="checkAnswer(1, 2, false)">
                Hierro y zinc
              </div>
            </div>
          </div>

          <div class="question" id="q2">
            <h3>2. ¿Cuántos huesos tiene el cuerpo humano adulto?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(2, 0, false)">150</div>
              <div class="option" onclick="checkAnswer(2, 1, true)">206</div>
              <div class="option" onclick="checkAnswer(2, 2, false)">300</div>
            </div>
          </div>

          <div class="question" id="q3">
            <h3>3. ¿Por qué son importantes los huesos para el ecosistema?</h3>
            <div class="options">
              <div class="option" onclick="checkAnswer(3, 0, false)">
                No tienen importancia
              </div>
              <div class="option" onclick="checkAnswer(3, 1, true)">
                Devuelven minerales al suelo y alimentan carroñeros
              </div>
              <div class="option" onclick="checkAnswer(3, 2, false)">
                Solo sirven para decorar
              </div>
            </div>
          </div>

          <div class="score" id="quizScore"></div>
          <button
            class="reset-btn"
            onclick="resetQuiz()"
            style="display: none"
            id="quizResetBtn"
          >
            Intentar de nuevo
          </button>
        </div>

        <div class="quiz-section skeleton-game">
          <h2>🎯 Tipos de Huesos</h2>
          <div class="game-instructions">
            Haz clic en cada hueso para descubrir su tipo y función
          </div>

          <div class="skeleton-grid">
            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">🦴</div>
              <div class="name">Huesos Largos</div>
              <p class="info">
                Como el fémur y húmero. Soportan peso y facilitan el movimiento.
              </p>
            </div>

            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">🔲</div>
              <div class="name">Huesos Cortos</div>
              <p class="info">
                Como los de la muñeca. Proporcionan estabilidad y poco
                movimiento.
              </p>
            </div>

            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">📄</div>
              <div class="name">Huesos Planos</div>
              <p class="info">
                Como las costillas y cráneo. Protegen órganos vitales.
              </p>
            </div>

            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">⚪</div>
              <div class="name">Huesos Irregulares</div>
              <p class="info">
                Como las vértebras. Tienen formas complejas y funciones
                especiales.
              </p>
            </div>

            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">🫁</div>
              <div class="name">Huesos Sesamoideos</div>
              <p class="info">
                Como la rótula. Están dentro de tendones y protegen
                articulaciones.
              </p>
            </div>

            <div class="bone-card" onclick="flipBone(this)">
              <div class="icon">🌊</div>
              <div class="name">Huesos Sutúrales</div>
              <p class="info">
                Pequeños huesos entre las placas del cráneo. Varían entre
                personas.
              </p>
            </div>
          </div>

          <div class="score" id="boneScore">Huesos descubiertos: 0/6</div>
          <button
            class="reset-btn"
            onclick="resetBones()"
            style="display: none"
            id="boneResetBtn"
          >
            Ocultar todo
          </button>
        </div>

        <div class="quiz-section matching-game">
          <h2>🧩 Juego: Empareja Animal con su Hueso</h2>
          <div class="game-instructions">
            Haz clic en un animal y luego en su característica ósea
          </div>

          <div class="matching-container">
            <div class="matching-column">
              <h3>Animales</h3>
              <div
                class="matching-item"
                data-id="bird"
                onclick="selectMatch('left', 'bird', this)"
              >
                🦅 Aves
              </div>
              <div
                class="matching-item"
                data-id="whale"
                onclick="selectMatch('left', 'whale', this)"
              >
                🐋 Ballenas
              </div>
              <div
                class="matching-item"
                data-id="snake"
                onclick="selectMatch('left', 'snake', this)"
              >
                🐍 Serpientes
              </div>
              <div
                class="matching-item"
                data-id="giraffe"
                onclick="selectMatch('left', 'giraffe', this)"
              >
                🦒 Jirafas
              </div>
            </div>

            <div class="matching-column">
              <h3>Características Óseas</h3>
              <div
                class="matching-item"
                data-id="whale"
                onclick="selectMatch('right', 'whale', this)"
              >
                Tienen huesos de dedos en sus aletas
              </div>
              <div
                class="matching-item"
                data-id="giraffe"
                onclick="selectMatch('right', 'giraffe', this)"
              >
                Tienen solo 7 vértebras en el cuello (como humanos)
              </div>
              <div
                class="matching-item"
                data-id="bird"
                onclick="selectMatch('right', 'bird', this)"
              >
                Sus huesos son huecos y livianos
              </div>
              <div
                class="matching-item"
                data-id="snake"
                onclick="selectMatch('right', 'snake', this)"
              >
                Pueden tener más de 300 vértebras
              </div>
            </div>
          </div>

          <div class="score" id="matchScore">Parejas correctas: 0/4</div>
          <button
            class="reset-btn"
            onclick="resetMatching()"
            style="display: none"
            id="matchResetBtn"
          >
            Jugar de nuevo
          </button>
        </div>
      </div>
    </div>

    <script>
      // Quiz
      let quizScore = 0;
      let quizAnswered = 0;
      const totalQuestions = 3;

      function checkAnswer(questionNum, optionIndex, isCorrect) {
        const question = document.getElementById('q' + questionNum);
        const options = question.querySelectorAll('.option');

        if (
          options[optionIndex].classList.contains('correct') ||
          options[optionIndex].classList.contains('incorrect')
        ) {
          return;
        }

        options.forEach((opt) => (opt.style.pointerEvents = 'none'));

        if (isCorrect) {
          options[optionIndex].classList.add('correct');
          quizScore++;
        } else {
          options[optionIndex].classList.add('incorrect');
          options.forEach((opt) => {
            if (opt.onclick.toString().includes('true')) {
              opt.classList.add('correct');
            }
          });
        }

        quizAnswered++;
        updateQuizScore();
      }

      function updateQuizScore() {
        const scoreDiv = document.getElementById('quizScore');
        const resetBtn = document.getElementById('quizResetBtn');

        if (quizAnswered === totalQuestions) {
          const percentage = (quizScore / totalQuestions) * 100;
          let message =
            percentage === 100
              ? '🎉 ¡Perfecto! ¡Eres un experto en huesos!'
              : percentage >= 66
              ? '👏 ¡Muy bien! Conoces mucho sobre los huesos.'
              : '🦴 ¡Sigue aprendiendo! Los huesos son fascinantes.';

          scoreDiv.innerHTML = `Puntuación: ${quizScore}/${totalQuestions}<br>${message}`;
          resetBtn.style.display = 'block';
        }
      }

      function resetQuiz() {
        quizScore = 0;
        quizAnswered = 0;

        for (let i = 1; i <= totalQuestions; i++) {
          const question = document.getElementById('q' + i);
          const options = question.querySelectorAll('.option');
          options.forEach((opt) => {
            opt.classList.remove('correct', 'incorrect');
            opt.style.pointerEvents = 'auto';
          });
        }

        document.getElementById('quizScore').innerHTML = '';
        document.getElementById('quizResetBtn').style.display = 'none';
      }

      // Bone Flip Game
      let flippedBones = 0;

      function flipBone(card) {
        if (!card.classList.contains('flipped')) {
          card.classList.add('flipped');
          flippedBones++;
          updateBoneScore();
        }
      }

      function updateBoneScore() {
        const scoreDiv = document.getElementById('boneScore');
        const resetBtn = document.getElementById('boneResetBtn');

        scoreDiv.textContent = `Huesos descubiertos: ${flippedBones}/6`;

        if (flippedBones === 6) {
          scoreDiv.innerHTML +=
            '<br>🎊 ¡Excelente! Descubriste todos los tipos de huesos!';
          resetBtn.style.display = 'block';
        }
      }

      function resetBones() {
        flippedBones = 0;

        document.querySelectorAll('.bone-card').forEach((card) => {
          card.classList.remove('flipped');
        });

        document.getElementById('boneScore').textContent =
          'Huesos descubiertos: 0/6';
        document.getElementById('boneResetBtn').style.display = 'none';
      }

      // Matching Game
      let selectedLeft = null;
      let selectedRight = null;
      let matchedPairs = 0;

      function selectMatch(side, id, element) {
        if (element.classList.contains('matched')) return;

        if (side === 'left') {
          // Deselect previous left selection
          if (selectedLeft && selectedLeft.element !== element) {
            selectedLeft.element.classList.remove('selected');
          }
          selectedLeft = { id, element };
          element.classList.add('selected');
        } else {
          // Deselect previous right selection
          if (selectedRight && selectedRight.element !== element) {
            selectedRight.element.classList.remove('selected');
          }
          selectedRight = { id, element };
          element.classList.add('selected');
        }

        // Check if both sides are selected
        if (selectedLeft && selectedRight) {
          checkMatch();
        }
      }

      function checkMatch() {
        if (selectedLeft.id === selectedRight.id) {
          // Correct match
          selectedLeft.element.classList.remove('selected');
          selectedRight.element.classList.remove('selected');
          selectedLeft.element.classList.add('matched');
          selectedRight.element.classList.add('matched');
          matchedPairs++;
          updateMatchScore();
        } else {
          // Incorrect match - remove selection after delay
          setTimeout(() => {
            selectedLeft.element.classList.remove('selected');
            selectedRight.element.classList.remove('selected');
          }, 800);
        }

        selectedLeft = null;
        selectedRight = null;
      }

      function updateMatchScore() {
        const scoreDiv = document.getElementById('matchScore');
        const resetBtn = document.getElementById('matchResetBtn');

        scoreDiv.textContent = `Parejas correctas: ${matchedPairs}/4`;

        if (matchedPairs === 4) {
          scoreDiv.innerHTML +=
            '<br>🎊 ¡Increíble! ¡Emparejaste todas correctamente!';
          resetBtn.style.display = 'block';
        }
      }

      function resetMatching() {
        matchedPairs = 0;
        selectedLeft = null;
        selectedRight = null;

        document.querySelectorAll('.matching-item').forEach((item) => {
          item.classList.remove('selected', 'matched');
        });

        document.getElementById('matchScore').textContent =
          'Parejas correctas: 0/4';
        document.getElementById('matchResetBtn').style.display = 'none';
      }

      // Puzzle Game
      let puzzlePlaced = 0;
      let draggedElement = null;
      let touchElement = null;
      let touchClone = null;

      function initPuzzle() {
        const pieces = document.querySelectorAll('.puzzle-piece');
        const slots = document.querySelectorAll('.puzzle-slot');

        pieces.forEach(piece => {
          // Mouse events
          piece.addEventListener('dragstart', handleDragStart);
          piece.addEventListener('dragend', handleDragEnd);

          // Touch events
          piece.addEventListener('touchstart', handleTouchStart, { passive: false });
          piece.addEventListener('touchmove', handleTouchMove, { passive: false });
          piece.addEventListener('touchend', handleTouchEnd, { passive: false });
        });

        slots.forEach(slot => {
          slot.addEventListener('dragover', handleDragOver);
          slot.addEventListener('drop', handleDrop);
        });
      }

      function handleDragStart(e) {
        draggedElement = e.target;
        e.target.style.opacity = '0.5';
      }

      function handleDragEnd(e) {
        e.target.style.opacity = '1';
      }

      function handleDragOver(e) {
        e.preventDefault();
      }

      function handleDrop(e) {
        e.preventDefault();

        const slot = e.currentTarget;
        const slotId = slot.dataset.id;
        const pieceId = draggedElement.dataset.id;

        if (slotId === pieceId && !slot.classList.contains('filled')) {
          const label = slot.querySelector('.slot-label');
          if (label) label.remove();

          slot.innerHTML = draggedElement.innerHTML;
          slot.classList.add('filled');
          slot.style.background = 'linear-gradient(135deg, #a67c52 0%, #c9a186 100%)';
          slot.style.border = '3px solid #4caf50';

          draggedElement.remove();
          puzzlePlaced++;
          updatePuzzleScore();
        }
      }

      // Touch event handlers for mobile
      function handleTouchStart(e) {
        e.preventDefault();
        touchElement = e.target;

        // Create a clone for visual feedback
        touchClone = touchElement.cloneNode(true);
        touchClone.style.position = 'fixed';
        touchClone.style.zIndex = '1000';
        touchClone.style.opacity = '0.8';
        touchClone.style.pointerEvents = 'none';
        touchClone.style.transform = 'scale(1.1)';
        document.body.appendChild(touchClone);

        touchElement.style.opacity = '0.3';

        const touch = e.touches[0];
        updateTouchClonePosition(touch);
      }

      function handleTouchMove(e) {
        e.preventDefault();
        if (!touchClone) return;

        const touch = e.touches[0];
        updateTouchClonePosition(touch);
      }

      function updateTouchClonePosition(touch) {
        if (!touchClone) return;
        touchClone.style.left = (touch.clientX - 40) + 'px';
        touchClone.style.top = (touch.clientY - 40) + 'px';
      }

      function handleTouchEnd(e) {
        e.preventDefault();

        if (!touchElement || !touchClone) return;

        const touch = e.changedTouches[0];
        const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);

        // Find the slot (might be the slot itself or a child)
        let slot = dropTarget;
        while (slot && !slot.classList.contains('puzzle-slot')) {
          slot = slot.parentElement;
        }

        if (slot && slot.classList.contains('puzzle-slot')) {
          const slotId = slot.dataset.id;
          const pieceId = touchElement.dataset.id;

          if (slotId === pieceId && !slot.classList.contains('filled')) {
            const label = slot.querySelector('.slot-label');
            if (label) label.remove();

            slot.innerHTML = touchElement.innerHTML;
            slot.classList.add('filled');
            slot.style.background = 'linear-gradient(135deg, #a67c52 0%, #c9a186 100%)';
            slot.style.border = '3px solid #4caf50';

            touchElement.remove();
            puzzlePlaced++;
            updatePuzzleScore();
          } else {
            // Wrong slot - restore opacity
            touchElement.style.opacity = '1';
          }
        } else {
          // Not dropped on a slot - restore opacity
          touchElement.style.opacity = '1';
        }

        // Clean up
        if (touchClone && touchClone.parentNode) {
          touchClone.remove();
        }
        touchClone = null;
        touchElement = null;
      }

      function updatePuzzleScore() {
        const scoreDiv = document.getElementById('puzzleScore');
        const resetBtn = document.getElementById('puzzleResetBtn');

        scoreDiv.textContent = `Piezas colocadas: ${puzzlePlaced}/6`;

        if (puzzlePlaced === 6) {
          scoreDiv.innerHTML += '<br>🎊 ¡Perfecto! ¡Completaste el esqueleto!';
          resetBtn.style.display = 'block';
        }
      }

      function resetPuzzle() {
        puzzlePlaced = 0;
        const container = document.getElementById('puzzlePieces');
        const slots = document.querySelectorAll('.puzzle-slot');

        slots.forEach(slot => {
          const slotId = slot.dataset.id;
          const labels = {
            'skull': 'Cráneo',
            'ribs': 'Costillas',
            'spine': 'Columna',
            'arm': 'Brazo',
            'pelvis': 'Pelvis',
            'leg': 'Pierna'
          };

          slot.innerHTML = `<span class="slot-label" style="font-size: 0.3em; color: #999;">${labels[slotId]}</span>`;
          slot.classList.remove('filled');
          slot.style.background = '';
          slot.style.border = '3px dashed #e8dfd6';
        });

        const pieces = [
          { id: 'leg', emoji: '🦵' },
          { id: 'skull', emoji: '💀' },
          { id: 'ribs', emoji: '🫁' },
          { id: 'arm', emoji: '💪' },
          { id: 'pelvis', emoji: '🦴' },
          { id: 'spine', emoji: '🔗' }
        ];

        container.innerHTML = pieces.map(p =>
          `<div class="puzzle-piece" draggable="true" data-id="${p.id}" style="padding: 20px; background: white; border: 3px solid #c9a186; border-radius: 10px; cursor: move; font-size: 3em; transition: all 0.3s ease;">${p.emoji}</div>`
        ).join('');

        document.getElementById('puzzleScore').textContent = 'Piezas colocadas: 0/6';
        document.getElementById('puzzleResetBtn').style.display = 'none';

        initPuzzle();
      }

      // Initialize puzzle on page load
      window.addEventListener('load', initPuzzle);
    </script>
  </body>
</html>
